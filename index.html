<!-- 
  Copyright (c) [Jun 2024] [OCA - https://www.youtube.com/@OCAudiophile]

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, and to permit persons to
  whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.

  Redistribution and use in source and binary forms, with or without
  modification, are not permitted for commercial purposes without the explicit
  permission of the author.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link href="./styles.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A1 Evo - OCA 2024</title>
</head>

<body>
  <div class="container">
    <h2>A1 Evo <strong>1-click</strong> Audyssey Optimization Tool <span class="version-number">v3z</span></h2>
    <h3>Steps</h3>
    <ol>
      <li class="smaller-font">Download and install the free room correction software Room EQ Wizard (at least v5.40 Beta 43) in your computer
        <ul style="margin-top: 0.5em;">
          <li class="small-bullet">Download link for the latest REW Beta version: <a href="https://www.avnirvana.com/threads/rew-api-beta-releases.12981/" target="_blank">here</a></li>
        </ul>
      </li>
      <li class="smaller-font">For advanced tips and the ultimate immersive audio experience, visit 'Obsessive Compulsive Audiophile' YT channel: <a href="https://www.youtube.com/channel/UCLePp5EV2RR5_Xo7rZnnpnQ?sub_confirmation=1" target="_blank">here</a></li>
      <li class="smaller-font">Click the 'Upload calibration' button below to browse to the Audyssey calibration file (.ady) generated by the MultEQ Editor (IOS/Android) app</li>
    </ol>
    <input type="file" id="fileInput" accept=".ady" onchange="extractAdy(event)">
    <div class="button-container">
      <button id="button1" onclick="document.getElementById('fileInput').click()">Upload calibration</button>
    </div>
    <ol start="5">
      <li class="smaller-font">Start REW, go to the 'EQ' / 'House Curve', navigate to and select the 'Evo3_TargetCurve.txt' file you've just saved</li>
      <li class="smaller-font">Let the app import the measurements onto REW. Wait until all measurements are imported and 'Optimize calibration' button is enabled</li>
      <li class="smaller-font">In REW left column you should be seeing your Audyssey speaker measurements with increasing index numbers sorted in alphabetical order</li>
      <li class="smaller-font">Start REW's local API (application programming interface) server - 'Preferences' / 'API' / 'Start server'</li>
      <li class="smaller-font">Keep REW at "SPL & Phase" tab and close all REW child windows during the optimization process for a robust experience</li>
      <li class="smaller-font">If you intend to run optimization multiple times with the same calibration: 'Save all', 'Remove all' and 'Open' saved measurements before each run</li>
      <li class="smaller-font">When all is set, click the 'Optimize calibration' button below and sit back and relax. Your home cinema will be 'transformed' within minutes!</li>
    </ol>
    <div class="button-container">
      <button id="button2" onclick="startButton_clicked()" disabled>Optimize calibration</button>
      <h1 class="logo">OCA 2024</h1>
    </div>

    <div class="customization-options">
      <small>    
        <label><input type="checkbox" id="forceSmall" onchange="updateCheckboxStates()"> Force small front speakers</label>
        <label><input type="checkbox" id="forceWeak" onchange="updateCheckboxStates()"> Force less powerful receiver</label>
        <label><input type="checkbox" id="forceCentre"onchange="updateCheckboxStates()"> Force sub alignment to centre speaker</label>
        <label><input type="checkbox" id="forceLarge" onchange="updateCheckboxStates()"> Force large front speakers</label>
        <label><input type="checkbox" id="noInversion"> Avoid sub(s) polarity inversion</label>
        <label><input type="checkbox" id="limitLPF"> Cap LFE+Main sub lpf frequency</label>
        <label><input type="checkbox" id="forceMLP"> Force 1st mic position @ MLP</label>
        <br>
        <label>End Frequency (100-10000):<input type="number" id="endFreq" name="endFreq" min="100" max="10000" value="250"/></label>
      </small>
    </div>
    <div class="notice">*Evo will perform best with default options with the majority of set ups</div>
    <h2 class="log-heading">Progress log:</h2>
    <pre id="logContainer"></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/13.0.3/math.min.js"></script>
    <script src="./renderer.js"></script>
  </div>
  
</body>