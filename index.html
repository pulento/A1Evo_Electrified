<!-- 
  Copyright (c) [Jun 2024] [OCA - https://www.youtube.com/@OCAudiophile]

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, and to permit persons to
  whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.

  Redistribution and use in source and binary forms, with or without
  modification, are not permitted for commercial purposes without the explicit
  permission of the author.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link href="./styles.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A1 Evo - OCA 2024</title>
</head>

<body onpageshow="getConfig()">
  <div class="container">
    <h2>A1 Evo <strong>1-click</strong> Audyssey Optimization Tool <span class="version-number">maestro mj</span></h2>
      <h3>Steps</h3>
      <ol>
        <li class="smaller-font">Download and install the free room correction software Room EQ Wizard (at least v5.40 Beta 48) in your computer
          <ul style="margin-top: 0.5em;">
            <li class="small-bullet">Download link for the latest REW Beta version: <a href="https://www.avnirvana.com/threads/rew-api-beta-releases.12981/" target="_blank">here</a></li>
          </ul>
        </li>
        <li class="smaller-font">For advanced tips and the ultimate immersive audio experience, visit 'Obsessive Compulsive Audiophile' YT channel: <a href="https://www.youtube.com/channel/UCLePp5EV2RR5_Xo7rZnnpnQ?sub_confirmation=1" target="_blank">here</a></li>
        <li class="smaller-font">Click the 'Upload calibration' button below to browse to the Audyssey calibration file (.ady) generated by the MultEQ Editor (IOS/Android) app</li>
        <li class="smaller-font">Don't forget to select your preferred Target Curve from the selector below if you haven't set it on your Settings</li>
      </ol>
      <input type="file" id="fileInput" accept=".ady" onchange="extractAdy(event)">
      <div class="button-container">
        <button id="button1" onclick="document.getElementById('fileInput').click()">Upload calibration</button>
      </div>
      <ol start="5">
        <li class="smaller-font">Wait until all measurements are imported and 'Optimize calibration' button is enabled</li>
        <li class="smaller-font">In REW left column you should be seeing your Audyssey speaker measurements with increasing index numbers sorted in alphabetical order</li>
        <li class="smaller-font">Keep REW at "SPL & Phase" tab and close all REW child windows during the optimization process for a robust experience</li>
        <li class="smaller-font">If you intend to run optimization multiple times with the same calibration: 'Save all', 'Remove all' and 'Open' saved measurements before each run</li>
        <li class="smaller-font">When all is set, click the 'Optimize calibration' button below and sit back and relax. Your home cinema will be 'transformed' within minutes!</li>
      </ol>
      <div class="button-container">
        <button id="button2" onclick="startButton_clicked()" disabled>Optimize calibration</button>
        <h1 class="logo">OCA 2024</h1>
      </div>
      <div class="customization-options">
        <small>    
          <label>
            <input type="checkbox" id="forceSmall" onchange="updateCheckboxStates('forceSmall')">
            Force small fronts
            <span class="explanation">If selected, front speakers will NOT be set to 'Large / Full range.'</span>
          </label>
          <label>
            <input type="checkbox" id="forceWeak" onchange="updateCheckboxStates('forceWeak')">
            Force weak receiver
            <span class="explanation">Select this option in systems with less powerful receivers and/or identical speakers, bed channels will be crossed over at 80Hz and Atmos channels at 120Hz.</span>
          </label>
          <label>
            <input type="checkbox" id="forceCentre" onchange="updateCheckboxStates('forceCentre')">
            Align sub to centre speaker
            <span class="explanation">Subwoofer(s) will be time aligned to the 'Centre' speaker, front speakers will be set to 'Large', 'Subwoofer Mode' will need to be set to 'LFE' in the receiver.</span>
          </label>
          <label>
            <input type="checkbox" id="forceLarge" onchange="updateCheckboxStates('forceLarge')">
            Force large fronts
            <span class="explanation">When selected, front speakers will NOT be set to 'Small'.</span>
          </label>
          <label>
            <input type="checkbox" id="noInversion" onchange="updateCheckboxStates('noInversion')">
            Avoid sub polarity inversion
            <span class="explanation">Avoids subwoofer polarity inversion checks in optimizations. Select this option if your sub(s) don't have a polarity/phase inversion flip switch.</span>
          </label>
          <label>
            <input type="checkbox" id="limitLPF" onchange="updateCheckboxStates('limitLPF')">
            Cap subwoofer LPF frequency
            <span class="explanation">Limits lowpass filter evaluation frequencies for even number of sub(s) (odd number of sub(s) are automatically limited) to avoid bass localization in 'LFE + Main' mode.</span>
          </label>
          <label>
            <input type="checkbox" id="forceMLP" onchange="updateCheckboxStates('forceMLP')">
            Force 1st mic position @ MLP
            <span class="explanation">Only first microphone position measurements will be used in calculations rather than average of all measured mic positions. May yield better results in certain room conditions.</span>
          </label>
        </small>
      </div>
      <div class="customization-options">
        <small>
          <label>
            Target Curve: <input type="text" onclick="targetDialog()" id="targetCurve" name="targetCurve" minlength="4" maxlength="200" size="80"/>
          </label>
          <label>
            Transition Frequency (100-1000): <input type="number" id="endFreq" name="endFreq" min="100" max="1000" value="250"/>
          </label>
          <label>
            Max Boost (0-12): <input type="number" id="maxBoost" name="maxBoost" min="0" max="12" value="0"/>
          </label>
          <label>
            Overall Max Boost (0-12): <input type="number" id="omaxBoost" name="omaxBoost" min="0" max="12" value="0"/>
          </label>
          <label>
            <input type="checkbox" id="eqHF" onchange="updateCheckboxStates('eqHF')"/>
            EQ over transition frequency
            <span class="explanation">Allow High Shelf EQ filter above transition frequency</span>
          </label>
          <label>
            High Frequency Limit (1000-20000): <input type="number" id="highFreq" name="highFreq" min="1000" max="20000" value="10000" disabled/>
          </label>
          <label>
            <input type="checkbox" id="allowHS" onchange="updateCheckboxStates('allowHS')" disabled />
            Allow High Shelf
            <span class="explanation">Allow High Shelf EQ filter above transition frequency</span>
          </label>
          <label>
            High Shelf Boost (0-6): <input type="number" id="hsFreq" name="hsFreq" min="0" max="6" value="2" disabled/>
          </label>
          <label>
            <input type="checkbox" id="usePSY" onchange="updateCheckboxStates('usePSY')" disabled />
            PSY Smoothing
            <span class="explanation">Use PSY smoothing for EQ above transition frequency</span>
          </label>
        </small>
      </div>

      <div class="notice">*Evo will perform best with the default options with majority of systems</div>
      <h3 class="collapsible">A1Evo Crossovers Preferences</h3>
      <div class="xo-content">
        <div class="bignotice">
          * Here you can set crossovers search ranges for each channel.<br>
          * Please note that values entered aren't check against your specificy AVR.<br>
          * Setting only the LOW value forces XO to that value.
        </div>
        <div id="run-xo-options" class="xo-options"></div>
      </div>
      <h2 class="log-heading">Progress log:</h2>
      <pre id="logContainer"></pre>
    </div>
    <pre id="logContainer"></pre>
    <script src="./renderer.js"></script>
  </div>
</body>